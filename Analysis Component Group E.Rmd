---
title: "Analysis Component Group E"
author: "E. Hauge, G. Henry, L. Kaminka"
date: "2024-03-28"
output:
  pdf_document:
    fig_height: 3
    fig_width: 5
  html_document:
    fig_height: 3
    fig_width: 5
  word_document:
    fig_height: 3
    fig_width: 5

---

```{r, include = FALSE}
library(mosaic)
options(digits = 6)
library(Stat2Data)
library(readr)
library(ggformula)
library(dplyr)
library(hrbrthemes)
library(stringr)
```





```{r}
SLD <- read_csv("data/SLD.csv", show_col_types = FALSE)

create_density_plots_all <- function(data, start_col, end_col) {
  numeric_vars <- names(data)[sapply(data, is.numeric)]
  selected_vars <- numeric_vars[start_col:end_col]
  
  for (var in selected_vars) {
    # Create density plot for each variable
    plot <- gf_density(as.formula(paste("~", var)), data = data, fill = ~CBSA_Name,  
                       title = paste("Density Plot of", var, "With Counties"))
    print(plot)
  }
}

NewYork_SanFrancisco_data <- read_csv("data/NewYork_SanFrancisco_data.csv", show_col_types = FALSE)

```


```{r}
create_density_plots_all(NewYork_SanFrancisco_data, 13, 33)
```


```{r}
create_density_plots_all(NewYork_SanFrancisco_data, 34, 54)
```


```{r}
create_density_plots_all(NewYork_SanFrancisco_data, 55, 76)
```

```{r}
create_density_plots_all(NewYork_SanFrancisco_data, 78, 98)
```

```{r}
create_density_plots_all(NewYork_SanFrancisco_data, 99, 118)
```



```{r}
#unique(SLD$CBSA_Name)
```

```{r}
#unique(SLD$CSA_Name)
```


```{r}
unique(NewYork_SanFrancisco_data$CBSA_Name)
```

```{r}
unique(NewYork_SanFrancisco_data$CSA_Name)
```



```{r}


names(NewYork_SanFrancisco_data)

#removing missing values. 
NewYork_SanFrancisco_data <- na.omit(NewYork_SanFrancisco_data)
```



#Univariate Analysis: 
```{r}

create_density_plots_subset <- function(data, start_col, end_col) {
  numeric_vars <- names(data)[sapply(data, is.numeric)]
  selected_vars <- numeric_vars[start_col:end_col]
  
  for (var in selected_vars) {
    # Create density plot for each variable
    plot <- gf_density(as.formula(paste("~", var)), data = data, fill = ~CSA_Name,  
                       title = paste("Density Plot of", var))
    print(plot)
  }
}

# Function to create density plots for all numeric variables


# Example usage:
# Assuming 'data' is your dataset and you want to create density plots for columns 1 to 10:
```

```{r}
create_density_plots_subset(NewYork_SanFrancisco_data, 13, 33)
```


```{r}
create_density_plots_subset(NewYork_SanFrancisco_data, 34, 54)
```


```{r}
create_density_plots_subset(NewYork_SanFrancisco_data, 55, 75)
```

```{r}
create_density_plots_subset(NewYork_SanFrancisco_data, 76, 96)
```


```{r}
create_density_plots_subset(NewYork_SanFrancisco_data, 97, 118)

```


# For columns 11 to 20:


#Selecting Variables (there is way too many of them to run ggpairs on all of them)
```{r, warning = FALSE}
NewYork_SanFrancisco_data <- NewYork_SanFrancisco_data %>%
  dplyr::mutate(CSA_Name_ABBREV = gsub("New York-Newark, NY-NJ-CT-PA", "NY", CSA_Name)) %>%
  mutate(CSA_Name_ABBREV = gsub("San Jose-San Francisco-Oakland, CA", "SF", CSA_Name))

# Remove leading and trailing whitespace
NewYork_SanFrancisco_data$CSA_Name_ABBREV <- trimws(NewYork_SanFrancisco_data$CSA_Name_ABBREV)

# Replace "New York-Newark, NY-NJ-CT-PA" with "NY"
NewYork_SanFrancisco_data$CSA_Name_ABBREV <- gsub("New York-Newark, NY-NJ-CT-PA", "NY", NewYork_SanFrancisco_data$CSA_Name_ABBREV)

# Replace "San Jose-San Francisco-Oakland, CA" with "SF"
NewYork_SanFrancisco_data$CSA_Name_ABBREV <- gsub("San Jose-San Francisco-Oakland, CA", "SF", NewYork_SanFrancisco_data$CSA_Name_ABBREV)
  
  
NY_SF_focus <- NewYork_SanFrancisco_data %>%
  select(NatWalkInd, CSA_Name_ABBREV, Ac_Unpr, P_WrkAge, P_WrkAge, Pct_AO0, Pct_AO1, Pct_AO2p, R_LowWageWk, R_MedWageWk, R_HiWageWk, R_PCTLOWWAGE, E_LowWageWk, E_MedWageWk, E_HiWageWk, E_PctLowWage, D5AR, D5AE, D5BR, D5BE, D2A_JPHH, D2A_WRKEMP, D3AAO, D3AMM, D3APO)


```

```{r, warnings=FALSE}
plot_1 <- suppressWarnings(GGally::ggpairs(NY_SF_focus[, c(1, 3:7)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the first 4 potential predictors"))
plot_1
```


```{r, warning=FALSE}

GGally::ggpairs(NY_SF_focus[, c(1, 8:12)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the next 5 potential predictors")
```

```{r, warning=FALSE}
GGally::ggpairs(NY_SF_focus[, c(1, 13:19)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the following 5 potential predictors")
```

```{r, warning=FALSE}
GGally::ggpairs(NY_SF_focus[, c(1, 20:24)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the last 4 potential predictors")
```




