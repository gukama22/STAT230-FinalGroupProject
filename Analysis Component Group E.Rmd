---
title: "Analysis Component Group E"
author: "E. Hauge, G. Henry, L. Kaminka"
date: "2024-03-28"
output:
  pdf_document:
    fig_height: 3
    fig_width: 5
  html_document:
    fig_height: 3
    fig_width: 5
  word_document:
    fig_height: 3
    fig_width: 5

---

```{r, include = FALSE}
library(mosaic)
library(GGally)
options(digits = 6)
library(Stat2Data)
library(readr)
library(ggformula)
library(dplyr)
library(hrbrthemes)
library(stringr)
```



```{r}
NewYork_SanFrancisco_data <- read_csv("data/NewYork_SanFrancisco_data.csv", show_col_types = FALSE)
```
#Selecting Variables (there is way too many of them to run ggpairs on all of them)
```{r}
NewYork_SanFrancisco_data <- NewYork_SanFrancisco_data %>%
  mutate(CSA_Name_ABBREV = gsub("New York-Newark, NY-NJ-CT-PA", "NY", CSA_Name)) %>%
  mutate(CSA_Name_ABBREV = gsub("San Jose-San Francisco-Oakland, CA", "SF", CSA_Name))

# Remove leading and trailing whitespace
NewYork_SanFrancisco_data$CSA_Name_ABBREV <- trimws(NewYork_SanFrancisco_data$CSA_Name_ABBREV)

# Replace "New York-Newark, NY-NJ-CT-PA" with "NY"
NewYork_SanFrancisco_data$CSA_Name_ABBREV <- gsub("New York-Newark, NY-NJ-CT-PA", "NY", NewYork_SanFrancisco_data$CSA_Name_ABBREV)

# Replace "San Jose-San Francisco-Oakland, CA" with "SF"
NewYork_SanFrancisco_data$CSA_Name_ABBREV <- gsub("San Jose-San Francisco-Oakland, CA", "SF", NewYork_SanFrancisco_data$CSA_Name_ABBREV)
  
  
NY_SF_focus <- NewYork_SanFrancisco_data %>%
  select(NatWalkInd, CSA_Name_ABBREV, Ac_Unpr, P_WrkAge, P_WrkAge, Pct_AO0, Pct_AO1, Pct_AO2p, R_LowWageWk, R_MedWageWk, R_HiWageWk, R_PCTLOWWAGE, E_LowWageWk, E_MedWageWk, E_HiWageWk, E_PctLowWage, D5AR, D5AE, D5BR, D5BE, D2A_JPHH, D2A_WRKEMP, D3AAO, D3AMM, D3APO)


ggpairs(NY_SF_focus[, c(1, 3:7)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the first 4 potential predictors")

ggpairs(NY_SF_focus[, c(1, 8:12)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the next 5 potential predictors")

ggpairs(NY_SF_focus[, c(1, 13:19)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the following 5 potential predictors")

ggpairs(NY_SF_focus[, c(1, 20:24)], 
        aes(color = NY_SF_focus$CSA_Name_ABBREV),
        title = "Scatterplot marix of NatWalkability Index Grouped by city", 
        subtitle = "Using the last 4 potential predictors")
```


